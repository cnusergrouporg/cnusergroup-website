---
import BaseLayout from '../../layouts/BaseLayout.astro';
import CityGrid from '../../components/sections/CityGrid.astro';
import Breadcrumb from '../../components/ui/Breadcrumb.astro';
import { getLanguageFromUrl, t } from '../../utils';

const lang = getLanguageFromUrl(Astro.url);
const pageTitle = t('cities.title', lang);
---

<BaseLayout title={pageTitle}>
  <!-- Breadcrumb Navigation -->
  <div class="bg-white py-4 border-b border-gray-200">
    <div class="container-custom">
      <Breadcrumb currentPath={Astro.url.pathname} lang={lang} />
    </div>
  </div>
  
  <!-- Page Header -->
  <div class="bg-gradient-to-r from-aws-blue to-blue-700 text-white py-16">
    <div class="container-custom text-center">
      <h1 class="text-4xl lg:text-5xl font-bold mb-4">
        {pageTitle}
      </h1>
      <p class="text-xl text-blue-100 max-w-3xl mx-auto">
        {t('cities.subtitle', lang)}
      </p>
    </div>
  </div>
  
  <!-- Search and Filter Bar -->
  <div class="bg-gray-50 py-8">
    <div class="container-custom">
      <div class="max-w-4xl mx-auto">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <!-- Search Input -->
          <div class="md:col-span-2">
            <div class="relative">
              <input
                type="text"
                id="city-search"
                placeholder={lang === 'zh' ? '搜索城市名称...' : 'Search city names...'}
                class="w-full px-4 py-3 pl-12 pr-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-aws-orange focus:border-transparent"
              />
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <svg class="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg>
              </div>
            </div>
          </div>
          
          <!-- Filter Dropdown -->
          <div class="relative">
            <select
              id="city-filter"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-aws-orange focus:border-transparent appearance-none bg-white"
            >
              <option value="all">{lang === 'zh' ? '所有城市' : 'All Cities'}</option>
              <option value="active">{lang === 'zh' ? '活跃社区' : 'Active Communities'}</option>
              <option value="north">{lang === 'zh' ? '华北地区' : 'North China'}</option>
              <option value="east">{lang === 'zh' ? '华东地区' : 'East China'}</option>
              <option value="south">{lang === 'zh' ? '华南地区' : 'South China'}</option>
              <option value="west">{lang === 'zh' ? '西部地区' : 'West China'}</option>
            </select>
            <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
              <svg class="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
              </svg>
            </div>
          </div>
        </div>
        
        <!-- Results Summary -->
        <div class="mt-4 flex items-center justify-between text-sm text-gray-600">
          <span id="results-count">
            {lang === 'zh' ? '显示所有城市' : 'Showing all cities'}
          </span>
          <button
            id="clear-filters"
            class="text-aws-orange hover:text-orange-600 transition-colors duration-200 hidden"
          >
            {lang === 'zh' ? '清除筛选' : 'Clear Filters'}
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- City Grid -->
  <CityGrid />
</BaseLayout>

<script>
  import '../../scripts/citySearch.ts';
</script>